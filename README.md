# マジカルミライ プログラミング・コンテスト 2025 投稿作品
アプリ名: [真夜中のお散歩](https://magical-mirai-procon-2025.vercel.app/)

チーム名： Melancholic Rain

チームメンバー:
- Stanaka: コードを書いた人
- Uta: 絵を描いた人

使用したフォント: レシートフォント (https://booth.pm/ja/items/6128508)

使用ライブラリ: textalive-app-api

これ（README）を描いた人: Stanaka

## アイデア出しの流れ
- ネギシャワーPの「ストリートライト」に一目（耳?）惚れしたので採用
- MVの雰囲気と、マジミラ2025のテーマ「星河一天」からテーマを「夜の街ｘ星」に決定
- 夜の街をキャラたちが歩きながら歌で星を灯していくイメージ
  - 選択中のキャラによって灯される星の色が変わるので、ユーザーの選択次第で歌詞の見た目が変わる。いんたらくてぃぶ。
- 曲ではピアプロキャラたちが勢揃いしてるので、アプリにも全員登場させたい（絵を描いた人、いっぱい描いてくれてありがとう！）
- でも一度に全員表示したら画面がごちゃりそう
  - 一人づつ表示させて好きに切り替えられるように
- でも全員を画面に収めたい
  - 最後に選択中以外のキャラが出迎えてくれる
- いんたらくてぃびてぃが足りないから気持ち程度のジャンプ機能を追加<-いる？<-いる。
- 曲の最後の方に流れ星を連想させる音があったので実装

## 実装面でのこだわり
- 使用ライブラリは`textalive-app-api`のみ！純粋な`html/css/js`でGood old dayを思い出そう！（縛りプレイ）
  - とはいえ`js`は書きたくないので`typescript`を採用
- なんちゃってDDD（ドメイン駆動開発）を意識
- どのコードがどこに置かれるべきかを考えて実装（Separation of Concerns）
- キャラの歩行アニメーションが曲にマッチするように秒数を設定
  - BPM117 -> 1ビートに(60 /117=) 0.513秒 -> 歩行アニメーションの秒数を(0.513 * 2=)1.026秒に設定
- 歩行アニメーションの微調整（Credits to 絵を描いた人）
- 背景の遠近法を実現するために、背景画像を3枚に分けて、別々のスピードでスクロール

## 実装してみた所感（思ったこと書き殴り）
- いつもはReactを使って開発しているので、脳みそがコンポーネント思考になっていた
  - ライブラリなしでのアーキテクチャだと、どのコードをどこに置けば良いのかに戸惑った
- 久々に生のCSS書いたけどやっぱ`tailwind`って神なんだな
  - でもコンポーネントベースじゃないアーキテクチャなら逆生CSSの方がにいいのかも？
  - あと`tailwind`じゃ難しい複雑なスタイルもあるからしょうがないか
- `textalive-app-api`神！使いやすい！
- Safariさんまじ勘弁してください。。。
  - 背景のlinear-gradationが表示されない
  - `animate`関数の`now`の値が曲の終了時の時間から始まる時があるバグ
    - 毎回起こるわけではない
    - ページをリロードすると直ったりする
    - Safari以外のブラウザでは確認できず
    - `textalive-app-api`のバグ？？？
    - 自前のタイマーを設けて、おかしな`now`の値を検知したら曲の最初までシークすることで無理やり直した（直ってません）
- でも全部ひっくるめて楽しかった！

## ミライについて
- 次は特定の曲ではなく、どんな曲も使える一般化されたアプリを作ってみたい
- 外部ライブラリを使用してもっと視覚的に複雑なあぷりを作りたい